language: scala
jdk: oraclejdk8
sudo: required

cache:
  directories:
    - $HOME/.ivy2
    - $HOME/.sbt

services:
  - docker

scala:
  - 2.10.6
  - 2.11.7

before_script:
  - sbt update # update dependencies here in order to cache them and mount them later to docker container

script:
  - docker run --rm -it -v $HOME/.ivy2:/root/.ivy2 -v $HOME/.sbt:/root/.sbt -v /var/run/docker.sock:/var/run/docker.sock -v $(which docker):/bin/docker -v $(pwd):/usr/src/riak-test-docker -w /usr/src/riak-test-docker asuprun/test-env sbt ++$TRAVIS_SCALA_VERSION test